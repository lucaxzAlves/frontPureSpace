{"ast":null,"code":"import React from\"react\";import{useRef,useState,useEffect}from\"react\";import'../styles/addPinPage.css';import{usePlacesList,useUpdatePlaces}from\"../placesContext.js\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function EditCard(_ref){let{sensorId,positionState}=_ref;const[sucess,setSucess]=useState(false);const refreshPlaces=useUpdatePlaces();const nameRef=useRef();const descRef=useRef();const imgRef=useRef();const[state,setState]=useState(false);const[positionPX,setStatePX]=useState({top:'0',left:'0'});const places=usePlacesList();const placeInfo=places.find(place=>place.id===sensorId);async function handleSubmit(e){e.preventDefault();const name=nameRef.current.value;const desc=descRef.current.value;const img=imgRef.current.files[0];const positionJSON=positionPX.left==='0'||positionPX.top==='0'?{top:placeInfo.position.top,left:placeInfo.position.left}:{left:`${positionPX.left}vw`,top:`${positionPX.top}vh`};const Finalimg=!img?placeInfo.img:img;const formData=new FormData();formData.append('id',sensorId);formData.append('name',name);formData.append('desc',desc);formData.append('position',JSON.stringify(positionJSON));formData.append('img',Finalimg);if(!name||!desc||!positionJSON){return;}await fetch('https://back-pure-space-g4cnbh202-lucas-projects-27aead0d.vercel.app/update/places',{method:'PATCH',body:formData});refreshPlaces();setSucess(true);}function handlePosition(){setState(true);document.body.style.cursor='crosshair';}useEffect(()=>{if(!state){return;}else{setState(false);setStatePX({...positionState});document.body.style.cursor='default';}},[positionState,state]);if(sucess){return/*#__PURE__*/_jsxs(\"div\",{className:\"sucess\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Sensor atualizado com sucesso!\"}),/*#__PURE__*/_jsx(\"img\",{className:\"svg1\",src:\"assets/undraw_success_288d.svg\",alt:\"\"}),/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Nome:\"}),\" \\\"\",placeInfo!==null&&placeInfo!==void 0&&placeInfo.name?placeInfo.name.length>20?placeInfo.desc.substring(0,20)+\"...\":placeInfo.name:\"\",\"\\\"\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"ID do Sensor:\"}),\" \",placeInfo.id]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Descri\\xE7\\xE3o:\"}),\" \\\"\",placeInfo!==null&&placeInfo!==void 0&&placeInfo.desc?placeInfo.desc.length>50?placeInfo.desc.substring(0,50)+\"...\":placeInfo.desc:\"\",\"\\\"\"]})]}),/*#__PURE__*/_jsx(\"button\",{children:\"Guia de Instala\\xE7\\xE3o\"})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"form-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Atualizar Pin\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"label\",{for:\"nome\",children:\"Nome do Pin\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",ref:nameRef,id:\"nome\",name:\"nome\",placeholder:\"Ex:Pin de Localiza\\xE7\\xE3o\",defaultValue:placeInfo.name,required:true}),/*#__PURE__*/_jsx(\"label\",{for:\"descricao\",children:\"Descri\\xE7\\xE3o\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"descricao\",ref:descRef,name:\"descricao\",placeholder:\"Descreva seu pin...\",defaultValue:placeInfo.desc,rows:\"2\",required:true}),/*#__PURE__*/_jsx(\"label\",{for:\"imagem\",children:\"Imagem Ilustrativa\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",ref:imgRef,id:\"imagem\",name:\"imagem\",accept:\".svg,.png,.jpg,.jpeg\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handlePosition,children:\"Atualizar posi\\xE7\\xE3o do Pin\"}),/*#__PURE__*/_jsx(\"p\",{className:\"selectPlace-msg\",style:{display:state?'block':'none'},children:\"clique em algum lugar no mapa para posicionar\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Atualizar Pin\"})]})]});}","map":{"version":3,"names":["React","useRef","useState","useEffect","usePlacesList","useUpdatePlaces","jsx","_jsx","jsxs","_jsxs","EditCard","_ref","sensorId","positionState","sucess","setSucess","refreshPlaces","nameRef","descRef","imgRef","state","setState","positionPX","setStatePX","top","left","places","placeInfo","find","place","id","handleSubmit","e","preventDefault","name","current","value","desc","img","files","positionJSON","position","Finalimg","formData","FormData","append","JSON","stringify","fetch","method","body","handlePosition","document","style","cursor","className","children","src","alt","length","substring","onSubmit","for","type","ref","placeholder","defaultValue","required","rows","accept","onClick","display"],"sources":["C:/Users/lukga/Documents/javaScript/css-html/PureSpaceReact/my-app/front-end/src/components/EditCard.js"],"sourcesContent":["import React from \"react\";\r\nimport { useRef, useState, useEffect } from \"react\";\r\nimport '../styles/addPinPage.css'\r\nimport { usePlacesList, useUpdatePlaces } from \"../placesContext.js\";\r\n\r\nexport default function EditCard({ sensorId, positionState }) {\r\n\r\n\r\n   const [sucess, setSucess] = useState(false)\r\n\r\n  const refreshPlaces = useUpdatePlaces()\r\n\r\n  const nameRef = useRef()\r\n  const descRef = useRef()\r\n  const imgRef = useRef()\r\n  const [state,setState] = useState(false)\r\n  const [positionPX, setStatePX] = useState({\r\n    top: '0',\r\n    left: '0'\r\n  })\r\n  const places = usePlacesList()\r\n  const placeInfo = places.find((place) => place.id === sensorId);\r\n\r\n \r\n\r\n async function handleSubmit(e) {\r\n     e.preventDefault();\r\n\r\n    const name = nameRef.current.value;\r\n    const desc = descRef.current.value;\r\n    const img = imgRef.current.files[0]; \r\n      \r\n    const positionJSON = (positionPX.left === '0' || positionPX.top === '0')\r\n    ? { top: placeInfo.position.top, left: placeInfo.position.left }\r\n    : { left : `${positionPX.left}vw`,\r\n        top : `${positionPX.top}vh`}\r\n    \r\n    const Finalimg = (!img)\r\n    ? placeInfo.img\r\n    : img\r\n    \r\n   \r\n\r\n    const formData = new FormData();\r\n    formData.append('id', sensorId);\r\n    formData.append('name', name);\r\n    formData.append('desc', desc);\r\n    formData.append('position', JSON.stringify(positionJSON));\r\n    formData.append('img', Finalimg);\r\n    \r\n    if (!name || !desc || !positionJSON) {\r\n      return\r\n    }\r\n \r\n    \r\n \r\n    await fetch('https://back-pure-space-g4cnbh202-lucas-projects-27aead0d.vercel.app/update/places', {\r\n        method: 'PATCH',\r\n        body: formData\r\n  })\r\n  refreshPlaces()\r\n  setSucess(true)\r\n }\r\n\r\n    function handlePosition() {\r\n     setState(true)\r\n     \r\n      document.body.style.cursor = 'crosshair';\r\n    }\r\n\r\n     useEffect(() => {\r\n          \r\n       if(!state)  {\r\n      return  \r\n     }\r\n      else {\r\n       setState(false)\r\n       setStatePX({ ...positionState });\r\n       document.body.style.cursor = 'default'\r\n      \r\n      } \r\n     },[positionState, state])    \r\n     \r\nif (sucess) {\r\n      return (\r\n        <div className=\"sucess\">\r\n        <h1>Sensor atualizado com sucesso!</h1>\r\n        <img className=\"svg1\" src=\"assets/undraw_success_288d.svg\" alt=\"\" />\r\n        <ul>\r\n          <li><strong>Nome:</strong> \"{placeInfo?.name ? (placeInfo.name.length > 20 ? placeInfo.desc.substring(0, 20) + \"...\" : placeInfo.name) : \"\"}\"</li>\r\n          <li><strong>ID do Sensor:</strong> {placeInfo.id}</li>\r\n          <li><strong>Descrição:</strong> \"{placeInfo?.desc ? (placeInfo.desc.length > 50 ? placeInfo.desc.substring(0, 50) + \"...\" : placeInfo.desc) : \"\"}\"</li>\r\n        </ul>\r\n        <button>Guia de Instalação</button>\r\n      </div>\r\n      )\r\n    }\r\n\r\n    return (\r\n      <div className=\"form-container\">\r\n    <h2>Atualizar Pin</h2>\r\n    <form onSubmit={handleSubmit}>\r\n      <label for=\"nome\">Nome do Pin</label>\r\n      <input type=\"text\" ref={nameRef} id=\"nome\" name=\"nome\" placeholder=\"Ex:Pin de Localização\" defaultValue={placeInfo.name} required />\r\n\r\n      <label for=\"descricao\">Descrição</label>\r\n      <textarea id=\"descricao\" ref={descRef} name=\"descricao\" placeholder=\"Descreva seu pin...\" defaultValue={placeInfo.desc} rows=\"2\" required></textarea>\r\n\r\n      <label for=\"imagem\">Imagem Ilustrativa</label>\r\n      <input type=\"file\" ref={imgRef} id=\"imagem\" name=\"imagem\" accept=\".svg,.png,.jpg,.jpeg\" />\r\n\r\n      <button type=\"button\" onClick={handlePosition}>Atualizar posição do Pin</button>\r\n      <p className=\"selectPlace-msg\" style={{ display: state ? 'block' : 'none' }}>clique em algum lugar no mapa para posicionar</p>\r\n      <button type=\"submit\">Atualizar Pin</button>\r\n    </form>\r\n  </div>\r\n    )\r\n}"],"mappings":"AAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CACzB,OAASC,MAAM,CAAEC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CACnD,MAAO,0BAA0B,CACjC,OAASC,aAAa,CAAEC,eAAe,KAAQ,qBAAqB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAErE,cAAe,SAAS,CAAAC,QAAQA,CAAAC,IAAA,CAA8B,IAA7B,CAAEC,QAAQ,CAAEC,aAAc,CAAC,CAAAF,IAAA,CAGzD,KAAM,CAACG,MAAM,CAAEC,SAAS,CAAC,CAAGb,QAAQ,CAAC,KAAK,CAAC,CAE5C,KAAM,CAAAc,aAAa,CAAGX,eAAe,CAAC,CAAC,CAEvC,KAAM,CAAAY,OAAO,CAAGhB,MAAM,CAAC,CAAC,CACxB,KAAM,CAAAiB,OAAO,CAAGjB,MAAM,CAAC,CAAC,CACxB,KAAM,CAAAkB,MAAM,CAAGlB,MAAM,CAAC,CAAC,CACvB,KAAM,CAACmB,KAAK,CAACC,QAAQ,CAAC,CAAGnB,QAAQ,CAAC,KAAK,CAAC,CACxC,KAAM,CAACoB,UAAU,CAAEC,UAAU,CAAC,CAAGrB,QAAQ,CAAC,CACxCsB,GAAG,CAAE,GAAG,CACRC,IAAI,CAAE,GACR,CAAC,CAAC,CACF,KAAM,CAAAC,MAAM,CAAGtB,aAAa,CAAC,CAAC,CAC9B,KAAM,CAAAuB,SAAS,CAAGD,MAAM,CAACE,IAAI,CAAEC,KAAK,EAAKA,KAAK,CAACC,EAAE,GAAKlB,QAAQ,CAAC,CAIhE,cAAe,CAAAmB,YAAYA,CAACC,CAAC,CAAE,CAC3BA,CAAC,CAACC,cAAc,CAAC,CAAC,CAEnB,KAAM,CAAAC,IAAI,CAAGjB,OAAO,CAACkB,OAAO,CAACC,KAAK,CAClC,KAAM,CAAAC,IAAI,CAAGnB,OAAO,CAACiB,OAAO,CAACC,KAAK,CAClC,KAAM,CAAAE,GAAG,CAAGnB,MAAM,CAACgB,OAAO,CAACI,KAAK,CAAC,CAAC,CAAC,CAEnC,KAAM,CAAAC,YAAY,CAAIlB,UAAU,CAACG,IAAI,GAAK,GAAG,EAAIH,UAAU,CAACE,GAAG,GAAK,GAAG,CACrE,CAAEA,GAAG,CAAEG,SAAS,CAACc,QAAQ,CAACjB,GAAG,CAAEC,IAAI,CAAEE,SAAS,CAACc,QAAQ,CAAChB,IAAK,CAAC,CAC9D,CAAEA,IAAI,CAAG,GAAGH,UAAU,CAACG,IAAI,IAAI,CAC7BD,GAAG,CAAG,GAAGF,UAAU,CAACE,GAAG,IAAI,CAAC,CAEhC,KAAM,CAAAkB,QAAQ,CAAI,CAACJ,GAAG,CACpBX,SAAS,CAACW,GAAG,CACbA,GAAG,CAIL,KAAM,CAAAK,QAAQ,CAAG,GAAI,CAAAC,QAAQ,CAAC,CAAC,CAC/BD,QAAQ,CAACE,MAAM,CAAC,IAAI,CAAEjC,QAAQ,CAAC,CAC/B+B,QAAQ,CAACE,MAAM,CAAC,MAAM,CAAEX,IAAI,CAAC,CAC7BS,QAAQ,CAACE,MAAM,CAAC,MAAM,CAAER,IAAI,CAAC,CAC7BM,QAAQ,CAACE,MAAM,CAAC,UAAU,CAAEC,IAAI,CAACC,SAAS,CAACP,YAAY,CAAC,CAAC,CACzDG,QAAQ,CAACE,MAAM,CAAC,KAAK,CAAEH,QAAQ,CAAC,CAEhC,GAAI,CAACR,IAAI,EAAI,CAACG,IAAI,EAAI,CAACG,YAAY,CAAE,CACnC,OACF,CAIA,KAAM,CAAAQ,KAAK,CAAC,oFAAoF,CAAE,CAC9FC,MAAM,CAAE,OAAO,CACfC,IAAI,CAAEP,QACZ,CAAC,CAAC,CACF3B,aAAa,CAAC,CAAC,CACfD,SAAS,CAAC,IAAI,CAAC,CAChB,CAEG,QAAS,CAAAoC,cAAcA,CAAA,CAAG,CACzB9B,QAAQ,CAAC,IAAI,CAAC,CAEb+B,QAAQ,CAACF,IAAI,CAACG,KAAK,CAACC,MAAM,CAAG,WAAW,CAC1C,CAECnD,SAAS,CAAC,IAAM,CAEd,GAAG,CAACiB,KAAK,CAAG,CACb,OACD,CAAC,IACK,CACJC,QAAQ,CAAC,KAAK,CAAC,CACfE,UAAU,CAAC,CAAE,GAAGV,aAAc,CAAC,CAAC,CAChCuC,QAAQ,CAACF,IAAI,CAACG,KAAK,CAACC,MAAM,CAAG,SAAS,CAEvC,CACD,CAAC,CAAC,CAACzC,aAAa,CAAEO,KAAK,CAAC,CAAC,CAE9B,GAAIN,MAAM,CAAE,CACN,mBACEL,KAAA,QAAK8C,SAAS,CAAC,QAAQ,CAAAC,QAAA,eACvBjD,IAAA,OAAAiD,QAAA,CAAI,gCAA8B,CAAI,CAAC,cACvCjD,IAAA,QAAKgD,SAAS,CAAC,MAAM,CAACE,GAAG,CAAC,gCAAgC,CAACC,GAAG,CAAC,EAAE,CAAE,CAAC,cACpEjD,KAAA,OAAA+C,QAAA,eACE/C,KAAA,OAAA+C,QAAA,eAAIjD,IAAA,WAAAiD,QAAA,CAAQ,OAAK,CAAQ,CAAC,MAAE,CAAC7B,SAAS,SAATA,SAAS,WAATA,SAAS,CAAEO,IAAI,CAAIP,SAAS,CAACO,IAAI,CAACyB,MAAM,CAAG,EAAE,CAAGhC,SAAS,CAACU,IAAI,CAACuB,SAAS,CAAC,CAAC,CAAE,EAAE,CAAC,CAAG,KAAK,CAAGjC,SAAS,CAACO,IAAI,CAAI,EAAE,CAAC,IAAC,EAAI,CAAC,cAClJzB,KAAA,OAAA+C,QAAA,eAAIjD,IAAA,WAAAiD,QAAA,CAAQ,eAAa,CAAQ,CAAC,IAAC,CAAC7B,SAAS,CAACG,EAAE,EAAK,CAAC,cACtDrB,KAAA,OAAA+C,QAAA,eAAIjD,IAAA,WAAAiD,QAAA,CAAQ,kBAAU,CAAQ,CAAC,MAAE,CAAC7B,SAAS,SAATA,SAAS,WAATA,SAAS,CAAEU,IAAI,CAAIV,SAAS,CAACU,IAAI,CAACsB,MAAM,CAAG,EAAE,CAAGhC,SAAS,CAACU,IAAI,CAACuB,SAAS,CAAC,CAAC,CAAE,EAAE,CAAC,CAAG,KAAK,CAAGjC,SAAS,CAACU,IAAI,CAAI,EAAE,CAAC,IAAC,EAAI,CAAC,EACrJ,CAAC,cACL9B,IAAA,WAAAiD,QAAA,CAAQ,0BAAkB,CAAQ,CAAC,EAChC,CAAC,CAER,CAEA,mBACE/C,KAAA,QAAK8C,SAAS,CAAC,gBAAgB,CAAAC,QAAA,eACjCjD,IAAA,OAAAiD,QAAA,CAAI,eAAa,CAAI,CAAC,cACtB/C,KAAA,SAAMoD,QAAQ,CAAE9B,YAAa,CAAAyB,QAAA,eAC3BjD,IAAA,UAAOuD,GAAG,CAAC,MAAM,CAAAN,QAAA,CAAC,aAAW,CAAO,CAAC,cACrCjD,IAAA,UAAOwD,IAAI,CAAC,MAAM,CAACC,GAAG,CAAE/C,OAAQ,CAACa,EAAE,CAAC,MAAM,CAACI,IAAI,CAAC,MAAM,CAAC+B,WAAW,CAAC,6BAAuB,CAACC,YAAY,CAAEvC,SAAS,CAACO,IAAK,CAACiC,QAAQ,MAAE,CAAC,cAEpI5D,IAAA,UAAOuD,GAAG,CAAC,WAAW,CAAAN,QAAA,CAAC,iBAAS,CAAO,CAAC,cACxCjD,IAAA,aAAUuB,EAAE,CAAC,WAAW,CAACkC,GAAG,CAAE9C,OAAQ,CAACgB,IAAI,CAAC,WAAW,CAAC+B,WAAW,CAAC,qBAAqB,CAACC,YAAY,CAAEvC,SAAS,CAACU,IAAK,CAAC+B,IAAI,CAAC,GAAG,CAACD,QAAQ,MAAW,CAAC,cAErJ5D,IAAA,UAAOuD,GAAG,CAAC,QAAQ,CAAAN,QAAA,CAAC,oBAAkB,CAAO,CAAC,cAC9CjD,IAAA,UAAOwD,IAAI,CAAC,MAAM,CAACC,GAAG,CAAE7C,MAAO,CAACW,EAAE,CAAC,QAAQ,CAACI,IAAI,CAAC,QAAQ,CAACmC,MAAM,CAAC,sBAAsB,CAAE,CAAC,cAE1F9D,IAAA,WAAQwD,IAAI,CAAC,QAAQ,CAACO,OAAO,CAAEnB,cAAe,CAAAK,QAAA,CAAC,gCAAwB,CAAQ,CAAC,cAChFjD,IAAA,MAAGgD,SAAS,CAAC,iBAAiB,CAACF,KAAK,CAAE,CAAEkB,OAAO,CAAEnD,KAAK,CAAG,OAAO,CAAG,MAAO,CAAE,CAAAoC,QAAA,CAAC,+CAA6C,CAAG,CAAC,cAC9HjD,IAAA,WAAQwD,IAAI,CAAC,QAAQ,CAAAP,QAAA,CAAC,eAAa,CAAQ,CAAC,EACxC,CAAC,EACJ,CAAC,CAER","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}