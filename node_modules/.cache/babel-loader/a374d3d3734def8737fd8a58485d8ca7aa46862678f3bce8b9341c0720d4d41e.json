{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\lukga\\\\Documents\\\\javaScript\\\\css-html\\\\PureSpaceReact\\\\my-app\\\\front-end\\\\src\\\\components\\\\Chart.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { Line } from 'react-chartjs-2';\nimport 'chart.js/auto';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function Chart({\n  id,\n  dataKey,\n  date\n}) {\n  _s();\n  const [chartData, setChartData] = useState({\n    labels: [],\n    datasets: [{\n      data: []\n    }]\n  });\n  const fetchData = async () => {\n    try {\n      const response = await fetch(`http://localhost:3000/api/medias${date}/${id}?timestamp=${Date.now()}`);\n      const dataMedia = await response.json();\n\n      // Força que dataMedia seja um array ou um array vazio para não quebrar o map\n      const dataArray = Array.isArray(dataMedia) ? dataMedia : [];\n      if (dataArray.length === 0) {\n        console.warn('API retornou vazio ou inválido:', dataMedia);\n        setChartData({\n          labels: ['Sem Dados'],\n          datasets: [{\n            data: [null]\n          }]\n        });\n        return;\n      }\n      const novasLabels = dataArray.map(d => d.timestamp ? new Date(d.timestamp).toLocaleDateString('pt-BR', {\n        day: 'numeric',\n        month: 'short'\n      }).replace(' de ', ' ') : 'Data inválida');\n      const novosDados = dataArray.map(d => d[dataKey] !== undefined ? parseFloat(d[dataKey]) : null);\n      setChartData({\n        labels: novasLabels,\n        datasets: [{\n          data: novosDados\n        }]\n      });\n    } catch (error) {\n      console.error('Erro no fetch:', error);\n      setChartData({\n        labels: ['Erro'],\n        datasets: [{\n          data: [null]\n        }]\n      });\n    }\n  };\n  useEffect(() => {\n    fetchData();\n    const interval = setInterval(() => {\n      fetchData();\n    }, 3000);\n    return () => clearInterval(interval);\n  }, [id, date, dataKey]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(Line, {\n      data: chartData,\n      options: {\n        responsive: true,\n        maintainAspectRatio: false,\n        scales: {\n          y: {\n            ticks: {\n              callback: function (context) {\n                if (dataKey.includes('ppm')) {\n                  return context.raw + 'ppm';\n                } else if (dataKey.includes('hum')) {\n                  return context.raw + '%';\n                } else if (dataKey.includes('temp')) {\n                  return context.raw + '°C';\n                }\n              }\n            }\n          },\n          x: {\n            display: true\n          }\n        },\n        plugins: {\n          legend: {\n            display: false\n          },\n          tooltip: {\n            callbacks: {\n              label: function (context) {\n                if (dataKey.includes('ppm')) {\n                  return context.raw + 'ppm';\n                } else if (dataKey.includes('hum')) {\n                  return context.raw + '%';\n                } else if (dataKey.includes('temp')) {\n                  return context.raw + '°C';\n                }\n              }\n            }\n          }\n        }\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n}\n_s(Chart, \"iJpGuM/w1wKE8SsAVjT9hHT2qXM=\");\n_c = Chart;\nvar _c;\n$RefreshReg$(_c, \"Chart\");","map":{"version":3,"names":["React","useEffect","useState","Line","jsxDEV","_jsxDEV","Fragment","_Fragment","Chart","id","dataKey","date","_s","chartData","setChartData","labels","datasets","data","fetchData","response","fetch","Date","now","dataMedia","json","dataArray","Array","isArray","length","console","warn","novasLabels","map","d","timestamp","toLocaleDateString","day","month","replace","novosDados","undefined","parseFloat","error","interval","setInterval","clearInterval","children","options","responsive","maintainAspectRatio","scales","y","ticks","callback","context","includes","raw","x","display","plugins","legend","tooltip","callbacks","label","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/lukga/Documents/javaScript/css-html/PureSpaceReact/my-app/front-end/src/components/Chart.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { Line } from 'react-chartjs-2';\r\nimport 'chart.js/auto';\r\n\r\n\r\nexport default function Chart({ id, dataKey, date }) {\r\n\r\n \r\n\r\n  const [chartData, setChartData] = useState({\r\n    labels: [],\r\n    datasets: [{\r\n      data: [],\r\n    }]\r\n  });\r\n\r\n const fetchData = async () => {\r\n  try {\r\n    const response = await fetch(`http://localhost:3000/api/medias${date}/${id}?timestamp=${Date.now()}`);\r\n    const dataMedia = await response.json();\r\n\r\n    // Força que dataMedia seja um array ou um array vazio para não quebrar o map\r\n    const dataArray = Array.isArray(dataMedia) ? dataMedia : [];\r\n\r\n    if (dataArray.length === 0) {\r\n      console.warn('API retornou vazio ou inválido:', dataMedia);\r\n      setChartData({\r\n        labels: ['Sem Dados'],\r\n        datasets: [{ data: [null] }]\r\n      });\r\n      return;\r\n    }\r\n\r\n    const novasLabels = dataArray.map(d =>\r\n      d.timestamp\r\n        ? new Date(d.timestamp).toLocaleDateString('pt-BR', {\r\n            day: 'numeric',\r\n            month: 'short'\r\n          }).replace(' de ', ' ')\r\n        : 'Data inválida'\r\n    );\r\n\r\n    const novosDados = dataArray.map(d =>\r\n      d[dataKey] !== undefined ? parseFloat(d[dataKey]) : null\r\n    );\r\n\r\n    setChartData({\r\n      labels: novasLabels,\r\n      datasets: [{ data: novosDados }]\r\n    });\r\n\r\n  } catch (error) {\r\n    console.error('Erro no fetch:', error);\r\n    setChartData({\r\n      labels: ['Erro'],\r\n      datasets: [{ data: [null] }]\r\n    });\r\n  }\r\n};\r\n  useEffect(() => {\r\n    fetchData(); \r\n\r\n    \r\n\r\n    const interval = setInterval(() => {\r\n      fetchData();\r\n    }, 3000);\r\n\r\n    return () => clearInterval(interval); \r\n  }, [id, date, dataKey]);\r\n\r\n  \r\n\r\n  return (\r\n    <>\r\n      <Line\r\n        data={chartData}\r\n        options={{\r\n          responsive: true,\r\n     maintainAspectRatio: false,\r\n          scales: {\r\n            y: {\r\n              ticks: {\r\n                callback: function(context) {\r\n                   if (dataKey.includes('ppm')) {\r\n                  return context.raw + 'ppm' }\r\n                else if (dataKey.includes('hum')) {\r\n                  return context.raw + '%'\r\n                } else if (dataKey.includes('temp')) {\r\n                  return context.raw + '°C'\r\n                }\r\n                }\r\n              }\r\n            },\r\n            x: { display: true }\r\n          },\r\n          plugins: {\r\n            legend: { display: false },\r\n            tooltip: {\r\n              callbacks: {\r\n                label: function(context) {\r\n                  if (dataKey.includes('ppm')) {\r\n                  return context.raw + 'ppm' }\r\n                else if (dataKey.includes('hum')) {\r\n                  return context.raw + '%'\r\n                } else if (dataKey.includes('temp')) {\r\n                  return context.raw + '°C'\r\n                }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }}\r\n      />\r\n    </>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}