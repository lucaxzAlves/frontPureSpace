{"ast":null,"code":"import React,{useEffect,useState}from'react';import{Line}from'react-chartjs-2';import'chart.js/auto';import{jsx as _jsx,Fragment as _Fragment}from\"react/jsx-runtime\";export default function Chart(_ref){let{id,dataKey,date}=_ref;const[chartData,setChartData]=useState({labels:[],datasets:[{data:[]}]});const fetchData=async()=>{try{const response=await fetch(`https://back-pure-space-g4cnbh202-lucas-projects-27aead0d.vercel.app/api/medias${date}/${id}?timestamp=${Date.now()}`);const dataMedia=await response.json();const dataArray=Array.isArray(dataMedia)?dataMedia:[];if(dataArray.length===0){console.warn('API retornou vazio ou inválido:',dataMedia);setChartData({labels:['Sem Dados'],datasets:[{data:[null]}]});return;}if(dataArray.length===0){return;}else{const novasLabels=dataArray.map(d=>d.timestamp?new Date(d.timestamp).toLocaleDateString('pt-BR',{day:'numeric',month:'short'}).replace(' de ',' '):'Data inválida');const novosDados=dataArray.map(d=>d[dataKey]!==undefined?parseFloat(d[dataKey]):null);setChartData({labels:novasLabels,datasets:[{data:novosDados}]});}}catch(error){console.error('Erro no fetch:',error);setChartData({labels:['Erro'],datasets:[{data:[null]}]});}};useEffect(()=>{fetchData();const interval=setInterval(()=>{fetchData();},3000);return()=>clearInterval(interval);},[id,date,dataKey]);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(Line,{data:chartData,options:{responsive:true,maintainAspectRatio:false,scales:{y:{ticks:{callback:function(context){if(dataKey.includes('ppm')){return context+'ppm';}else if(dataKey.includes('hum')){return context+'%';}else if(dataKey.includes('temp')){return context+'°C';}}}},x:{display:true}},plugins:{legend:{display:false},tooltip:{callbacks:{label:function(context){if(dataKey.includes('ppm')){return context.raw+'ppm';}else if(dataKey.includes('hum')){return context.raw+'%';}else if(dataKey.includes('temp')){return context.raw+'°C';}}}}}}})});}","map":{"version":3,"names":["React","useEffect","useState","Line","jsx","_jsx","Fragment","_Fragment","Chart","_ref","id","dataKey","date","chartData","setChartData","labels","datasets","data","fetchData","response","fetch","Date","now","dataMedia","json","dataArray","Array","isArray","length","console","warn","novasLabels","map","d","timestamp","toLocaleDateString","day","month","replace","novosDados","undefined","parseFloat","error","interval","setInterval","clearInterval","children","options","responsive","maintainAspectRatio","scales","y","ticks","callback","context","includes","x","display","plugins","legend","tooltip","callbacks","label","raw"],"sources":["C:/Users/lukga/Documents/javaScript/css-html/PureSpaceReact/my-app/front-end/src/components/Chart.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { Line } from 'react-chartjs-2';\r\nimport 'chart.js/auto';\r\n\r\n\r\nexport default function Chart({ id, dataKey, date }) {\r\n\r\n \r\n\r\n  const [chartData, setChartData] = useState({\r\n    labels: [],\r\n    datasets: [{\r\n      data: [],\r\n    }]\r\n  });\r\n\r\n const fetchData = async () => {\r\n  try {\r\n    const response = await fetch(`https://back-pure-space-g4cnbh202-lucas-projects-27aead0d.vercel.app/api/medias${date}/${id}?timestamp=${Date.now()}`);\r\n    const dataMedia = await response.json();\r\n\r\n  \r\n    const dataArray = Array.isArray(dataMedia) ? dataMedia : [];\r\n\r\n    if (dataArray.length === 0) {\r\n\r\n      console.warn('API retornou vazio ou inválido:', dataMedia);\r\n      setChartData({\r\n        labels: ['Sem Dados'],\r\n        datasets: [{ data: [null] }]\r\n      });\r\n      return;\r\n    }\r\n         if (dataArray.length === 0) {\r\n          return \r\n         } else {\r\n    const novasLabels = dataArray.map(d =>\r\n      d.timestamp\r\n        ? new Date(d.timestamp).toLocaleDateString('pt-BR', {\r\n            day: 'numeric',\r\n            month: 'short'\r\n          }).replace(' de ', ' ')\r\n        : 'Data inválida'\r\n    ); \r\n    \r\n    \r\n    const novosDados = dataArray.map(d =>\r\n      d[dataKey] !== undefined ? parseFloat(d[dataKey]) : null\r\n    ); \r\n\r\n    setChartData({\r\n      labels: novasLabels,\r\n      datasets: [{ data: novosDados }]\r\n    });\r\n         }\r\n  } catch (error) {\r\n    console.error('Erro no fetch:', error);\r\n    setChartData({\r\n      labels: ['Erro'],\r\n      datasets: [{ data: [null] }]\r\n    });\r\n  }\r\n};\r\n  useEffect(() => {\r\n    fetchData(); \r\n\r\n    \r\n\r\n    const interval = setInterval(() => {\r\n      fetchData();\r\n    }, 3000);\r\n\r\n    return () => clearInterval(interval); \r\n  }, [id, date, dataKey]);\r\n\r\n  \r\n\r\n  return (\r\n    <>\r\n      <Line\r\n        data={chartData}\r\n        options={{\r\n          responsive: true,\r\n     maintainAspectRatio: false,\r\n          scales: {\r\n            y: {\r\n              ticks: {\r\n                callback: function(context) {\r\n                   if (dataKey.includes('ppm')) {\r\n                  return context + 'ppm' }\r\n                else if (dataKey.includes('hum')) {\r\n                  return context + '%'\r\n                } else if (dataKey.includes('temp')) {\r\n                  return context + '°C'\r\n                }\r\n                }\r\n              }\r\n            },\r\n            x: { display: true }\r\n          },\r\n          plugins: {\r\n            legend: { display: false },\r\n            tooltip: {\r\n              callbacks: {\r\n                label: function(context) {\r\n                  if (dataKey.includes('ppm')) {\r\n                  return context.raw + 'ppm' }\r\n                else if (dataKey.includes('hum')) {\r\n                  return context.raw + '%'\r\n                } else if (dataKey.includes('temp')) {\r\n                  return context.raw + '°C'\r\n                }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }}\r\n      />\r\n    </>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}