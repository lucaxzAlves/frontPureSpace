{"ast":null,"code":"import React from\"react\";import{useRef,useState,useEffect}from\"react\";import'../styles/addPinPage.css';import{usePlacesList,useUpdatePlaces}from\"../placesContext.js\";import TutorialModal from\"./tutorialModal.js\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function AddCard(_ref){let{positionState}=_ref;const[error,setError]=useState(false);const[sucess,setSucess]=useState(false);const[modal,SetModal]=useState(false);const refreshPlaces=useUpdatePlaces();const nameRef=useRef();const descRef=useRef();const imgRef=useRef();const[state,setState]=useState(false);const[positionPX,setStatePX]=useState({top:'0',left:'0'});const places=usePlacesList();const place=places[places.length-1];async function handleSubmit(e){e.preventDefault();const name=nameRef.current.value;const desc=descRef.current.value;const img=imgRef.current.files[0];const lastId=Number(places[places.length-1].id);const id=lastId+1;const positionJSON={};positionJSON.left=`${positionPX.left}vw`;positionJSON.top=`${positionPX.top}vh`;const formData=new FormData();formData.append('id',id.toString());formData.append('name',name);formData.append('desc',desc);formData.append('position',JSON.stringify(positionJSON));formData.append('img',img);if(!name||!desc||!positionJSON||!img){setError(true);return;}await fetch('https://back-pure-space-g4cnbh202-lucas-projects-27aead0d.vercel.app/send/places',{method:'POST',body:formData});setSucess(true);refreshPlaces();}function handlePosition(){setState(true);document.body.style.cursor='crosshair';}useEffect(()=>{if(!state){return;}else{setState(false);setStatePX({...positionState});document.body.style.cursor='default';}},[positionState]);if(sucess){return/*#__PURE__*/_jsxs(\"div\",{className:\"sucess\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Sensor adicionado com sucesso!\"}),/*#__PURE__*/_jsx(\"img\",{className:\"svg1\",src:\"assets/undraw_success_288d.svg\",alt:\"\"}),/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Nome:\"}),\" \\\"\",place.name,\"\\\"\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"ID do Sensor:\"}),\" \",place.id]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Descri\\xE7\\xE3o:\"}),\" \\\"\",place!==null&&place!==void 0&&place.desc?place.desc.length>50?place.desc.substring(0,50)+\"...\":place.desc:\"\",\"\\\"\"]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{SetModal(true);},children:\"Guia de Instala\\xE7\\xE3o\"}),/*#__PURE__*/_jsx(TutorialModal,{open:modal,fecharModal:()=>SetModal(false)})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"form-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Adicionar Novo Pin\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"label\",{for:\"nome\",children:\"Nome do Pin\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",ref:nameRef,id:\"nome\",name:\"nome\",placeholder:\"Ex:Pin de Localiza\\xE7\\xE3o\",required:true}),/*#__PURE__*/_jsx(\"label\",{for:\"descricao\",children:\"Descri\\xE7\\xE3o\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"descricao\",ref:descRef,name:\"descricao\",placeholder:\"Descreva seu pin...\",rows:\"2\",required:true}),/*#__PURE__*/_jsx(\"label\",{for:\"imagem\",children:\"Imagem Ilustrativa\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",ref:imgRef,id:\"imagem\",name:\"imagem\",accept:\".svg,.png,.jpg,.jpeg\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"error-msg\",style:{display:error?'block':'none'},children:[\"Preencha todos os campos para continuar\",/*#__PURE__*/_jsx(\"span\",{className:\"dot\",children:\".\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handlePosition,children:\"Escolha posi\\xE7\\xE3o do Pin\"}),/*#__PURE__*/_jsx(\"p\",{className:\"selectPlace-msg\",style:{display:state?'block':'none'},children:\"clique em algum lugar no mapa para posicionar\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Salvar Pin\"})]})]});}","map":{"version":3,"names":["React","useRef","useState","useEffect","usePlacesList","useUpdatePlaces","TutorialModal","jsx","_jsx","jsxs","_jsxs","AddCard","_ref","positionState","error","setError","sucess","setSucess","modal","SetModal","refreshPlaces","nameRef","descRef","imgRef","state","setState","positionPX","setStatePX","top","left","places","place","length","handleSubmit","e","preventDefault","name","current","value","desc","img","files","lastId","Number","id","positionJSON","formData","FormData","append","toString","JSON","stringify","fetch","method","body","handlePosition","document","style","cursor","className","children","src","alt","substring","onClick","open","fecharModal","onSubmit","for","type","ref","placeholder","required","rows","accept","display"],"sources":["C:/Users/lukga/Documents/javaScript/css-html/PureSpaceReact/my-app/front-end/src/components/AddPin.js"],"sourcesContent":["import React from \"react\";\r\nimport { useRef, useState, useEffect } from \"react\";\r\nimport '../styles/addPinPage.css'\r\nimport { usePlacesList, useUpdatePlaces } from \"../placesContext.js\";\r\nimport TutorialModal from \"./tutorialModal.js\";\r\n\r\nexport default function AddCard({ positionState }) {\r\n\r\n  const [error, setError] = useState(false)\r\n  const [sucess, setSucess] = useState(false)\r\n  const [modal, SetModal] = useState(false) \r\n\r\n  const refreshPlaces = useUpdatePlaces()\r\n\r\n  const nameRef = useRef()\r\n  const descRef = useRef()\r\n  const imgRef = useRef()\r\n  const [state,setState] = useState(false)\r\n  const [positionPX, setStatePX] = useState({\r\n    top: '0',\r\n    left: '0'\r\n  })\r\n  const places = usePlacesList()\r\n  const place = places[places.length-1]\r\n\r\n async function handleSubmit(e) {\r\n     e.preventDefault();\r\n\r\n    const name = nameRef.current.value;\r\n    const desc = descRef.current.value;\r\n    const img = imgRef.current.files[0]; \r\n      \r\n    \r\n    const lastId = Number(places[places.length-1].id)\r\n    const id = lastId+1\r\n    \r\n   const positionJSON = {}\r\n\r\n    positionJSON.left = `${positionPX.left}vw`\r\n    positionJSON.top = `${positionPX.top}vh`\r\n    \r\n   \r\n\r\n    const formData = new FormData();\r\n    formData.append('id', id.toString());\r\n    formData.append('name', name);\r\n    formData.append('desc', desc);\r\n    formData.append('position', JSON.stringify(positionJSON));\r\n    formData.append('img', img);\r\n    \r\n    if (!name || !desc || !positionJSON || !img) {\r\n      setError(true)\r\n      return\r\n    }\r\n \r\n    \r\n \r\n    await fetch('https://back-pure-space-g4cnbh202-lucas-projects-27aead0d.vercel.app/send/places', {\r\n        method: 'POST',\r\n        body: formData\r\n  }) \r\n  setSucess(true)\r\n  refreshPlaces()\r\n }\r\n\r\n    function handlePosition() {\r\n     setState(true)\r\n     \r\n      document.body.style.cursor = 'crosshair';\r\n    }\r\n\r\n     useEffect(() => {\r\n          \r\n       if(!state)  {\r\n      return  \r\n     }\r\n      else {\r\n       setState(false)\r\n       setStatePX({ ...positionState });\r\n       document.body.style.cursor = 'default'\r\n      \r\n      } \r\n     },[positionState])    \r\n     \r\n    if (sucess) {\r\n      return (\r\n        <div className=\"sucess\">\r\n        <h1>Sensor adicionado com sucesso!</h1>\r\n        <img className=\"svg1\" src=\"assets/undraw_success_288d.svg\" alt=\"\" />\r\n        <ul>\r\n          <li><strong>Nome:</strong> \"{place.name}\"</li>\r\n          <li><strong>ID do Sensor:</strong> {place.id}</li>\r\n          <li><strong>Descrição:</strong> \"{place?.desc ? (place.desc.length > 50 ? place.desc.substring(0, 50) + \"...\" : place.desc) : \"\"}\"</li>\r\n        </ul>\r\n        <button onClick={() => {SetModal(true)}}>Guia de Instalação</button>\r\n        <TutorialModal open={modal} fecharModal={() => SetModal(false)} />\r\n      </div>\r\n      )\r\n    }\r\n\r\n    return (\r\n      <div className=\"form-container\">\r\n    <h2>Adicionar Novo Pin</h2>\r\n    <form onSubmit={handleSubmit}>\r\n      <label for=\"nome\">Nome do Pin</label>\r\n      <input type=\"text\" ref={nameRef} id=\"nome\" name=\"nome\" placeholder=\"Ex:Pin de Localização\" required />\r\n\r\n      <label for=\"descricao\">Descrição</label>\r\n      <textarea id=\"descricao\" ref={descRef} name=\"descricao\" placeholder=\"Descreva seu pin...\" rows=\"2\" required></textarea>\r\n\r\n      <label for=\"imagem\">Imagem Ilustrativa</label>\r\n      <input type=\"file\" ref={imgRef} id=\"imagem\" name=\"imagem\" accept=\".svg,.png,.jpg,.jpeg\" />\r\n\r\n      <p className=\"error-msg\" style={{ display: error ? 'block' : 'none' }}>Preencha todos os campos para continuar<span className=\"dot\">.</span></p>\r\n\r\n      <button type=\"button\" onClick={handlePosition}>Escolha posição do Pin</button>\r\n      <p className=\"selectPlace-msg\" style={{ display: state ? 'block' : 'none' }}>clique em algum lugar no mapa para posicionar</p>\r\n      <button type=\"submit\">Salvar Pin</button>\r\n      \r\n    </form>\r\n  </div>\r\n    )\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}